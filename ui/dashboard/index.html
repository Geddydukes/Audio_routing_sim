<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AERS Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="aers-header">
      <h1>AERS â€“ Audio Event Routing Simulator</h1>
      <p class="subtitle">Real-time node metrics</p>
    </header>

    <main class="aers-main">
      <!-- Tab Navigation -->
      <div class="tabs-container">
        <button class="tab-btn active" data-tab="metrics">Metrics</button>
        <button class="tab-btn" data-tab="graph">Graph Editor</button>
      </div>

      <!-- Metrics Tab -->
      <div id="metrics-tab" class="tab-content active">
        <section class="panel">
          <h2>WebSocket Status</h2>
          <div id="ws-status" class="status status-disconnected">
            Disconnected
          </div>
        </section>

      <section class="panel">
        <h2>Upload Audio</h2>
        <div class="upload-section">
          <input
            type="file"
            id="audio-file-input"
            accept=".wav,.flac,.mp3,.ogg,.m4a,.aac"
            style="display: none"
          />
          <button id="upload-btn" class="upload-button">Choose Audio File</button>
          <div id="upload-status" class="upload-status"></div>
          
          <!-- Audio playback controls -->
          <div id="audio-controls" class="audio-controls" style="display: none;">
            <button id="mute-btn" class="mute-button">ğŸ”Š Mute</button>
            <audio id="audio-player" loop autoplay></audio>
          </div>
        </div>
      </section>

      <section class="panel">
        <h2>Node Levels</h2>
        <div id="nodes-container" class="nodes-container">
          <!-- node cards injected here -->
        </div>
      </section>

        <section class="panel" id="timeline-panel" style="display: none;">
          <h2>Audio Timeline</h2>
          <!-- Global timeline visualization -->
          <div id="global-timeline-container" class="global-timeline-container">
            <canvas id="global-timeline-canvas" class="global-timeline-canvas"></canvas>
            <div id="timeline-time-labels" class="timeline-time-labels"></div>
          </div>
        </section>
      </div>

      <!-- Graph Editor Tab -->
      <div id="graph-tab" class="tab-content" style="display: none;">
        <div class="graph-editor-container">
          <!-- Node Palette -->
          <div class="node-palette">
            <h3>Nodes</h3>
            <div class="palette-item" draggable="true" data-kind="sine">
              <span class="palette-icon">ğŸ“»</span>
              <span class="palette-label">Sine</span>
            </div>
            <div class="palette-item" draggable="true" data-kind="gain">
              <span class="palette-icon">ğŸ”Š</span>
              <span class="palette-label">Gain</span>
            </div>
            <div class="palette-item" draggable="true" data-kind="eq">
              <span class="palette-icon">ğŸ›ï¸</span>
              <span class="palette-label">EQ</span>
            </div>
            <div class="palette-item" draggable="true" data-kind="delay">
              <span class="palette-icon">â±ï¸</span>
              <span class="palette-label">Delay</span>
            </div>
            <div class="palette-item" draggable="true" data-kind="passthrough">
              <span class="palette-icon">â†—ï¸</span>
              <span class="palette-label">Passthrough</span>
            </div>
          </div>

          <!-- Graph Canvas -->
          <div class="graph-canvas-wrapper">
            <svg id="graph-canvas" width="100%" height="100%">
              <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                  <polygon points="0 0, 10 3, 0 6" fill="#4CAF50" />
                </marker>
              </defs>
            </svg>
            <div class="graph-controls-overlay">
              <button id="save-layout-btn" class="graph-btn">ğŸ’¾ Save Layout</button>
              <button id="reset-zoom-btn" class="graph-btn">ğŸ” Reset Zoom</button>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="aers-footer">
      <span id="last-update">Last update: â€”</span>
    </footer>

    <script src="app.js"></script>
    <script src="graph-editor.js"></script>
  </body>
</html>

